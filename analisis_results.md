## Общая сводка

| Инструмент               | Статус     | Найдено проблем | Подтверждено | Комментарий                                 |
|--------------------------|------------|------------------|---------------|----------------------------------------------|
| Gitleaks                 | Успешно    | 5                | 0             | Ложные срабатывания                          |
| PHPStan (SAST)           | Успешно    | 6                | 6             | Потенциально эксплуатируемые ошибки          |
| OWASP Dependency Check   | Неудача    | -                | -             | Ошибка в CI при сохранении артефакта         |
| OWASP ZAP (DAST)         | Успешно    | 27 предупреждений| 5+            | Реальные уязвимости подтверждены вручную     |

---

## Secrets Scan — Gitleaks

Файл: `app/top_security.php`  
Обнаружены совпадения по шаблону `generic-api-key` в строках 24–28.  
Фрагмент кода:

```php
$secret = "PGk+PHA+U2VjdXJlIHRoZSB3b3JsZC4g...";
$secret .= "...";
```

Содержимое — base64-кодированный HTML-текст, не связанный с API-ключами, паролями или токенами.  
Декодирование показывает художественный текст. Доступ к внешним ресурсам по этим значениям отсутствует.

Вывод: ложные срабатывания.

---

## Static Analysis — PHPStan

Файл: `app/admin/index.php`  
Найдены следующие проблемы:

```php
132: echo $smtp_server;
140: echo $AIM_IPs[0];
148: echo $evil_bee;
156: $link = "login/" . $login;
```

Комментарии PHPStan:

- `$smtp_server`, `$AIM_IPs`, `$evil_bee`, `$login` — переменные могут быть не инициализированы
- Операции над типом `mixed` без проверки типа
- Результаты могут привести к ошибке исполнения или неконтролируемому выводу

Вывод: ошибки подтверждены, требуют защиты и проверки типов. True positive.

---

## Component Analysis — Dependency Check

Инструмент: OWASP Dependency Check  
Метод: сканирование директорий проекта на уязвимые зависимости  
CI-интеграция: GitHub Actions (job `dependency-check`)

**Результат:**  
Сканирование не завершено: отчёт не был сохранён из-за ошибки на этапе выгрузки артефакта.

**Ошибка:**  

Missing download info for actions/upload-artifact@v3

**Анализ:**  
Проблема связана с техническим ограничением runner'а GitHub Actions: не удалось загрузить модуль сохранения отчёта. В самом процессе сканирования ошибок не зафиксировано.

**Вывод:**  
Повторный запуск job необходим после корректной настройки `upload-artifact`. На текущем этапе результат отсутствует.

---

## DAST — OWASP ZAP

Инструмент: OWASP ZAP  
URL: `https://e1bf-5-231-41-176.ngrok-free.app`  
Метод: динамическое тестирование веб-приложения

Результаты:

- PASS: 39
- WARN: 27
- FAIL: 0

Подтвержденные уязвимости:

1. Directory Browsing  
   URL: `/documents/`  
   Возможность просмотра структуры каталогов.

2. Source Code Disclosure  
   URL: `/passwords/wp-config.bak`  
   Файл конфигурации PHP открыт к чтению, возможно содержит пароли.

3. Missing Anti-CSRF Tokens  
   Страницы: `login.php`, `user_new.php`  
   Формы не содержат токены CSRF, возможна подмена запроса.

4. Потенциальный XSS  
   URL: `login.php`, `user_new.php`  
   HTML-атрибуты управляются пользователем, может привести к XSS.

5. Отсутствие защитных заголовков:  
   `Content-Security-Policy`, `X-Frame-Options`, `Strict-Transport-Security`  
   Повышенный риск атак через браузер.

Вывод: уязвимости подтверждены, требуют устранения.
