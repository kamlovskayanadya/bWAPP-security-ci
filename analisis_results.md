## Secrets Scan — анализ строк 24–28, файл `app/top_security.php`

Gitleaks сообщил о 5 строках, совпадающих с шаблоном `generic-api-key`. Строки являются base64-кодированной строкой, содержащей HTML-текст (разметку и месседж, встроенный в страницу).

**Результат декодирования:** <i><p>Secure the world. Fight crime and senseless violence...</p> ... </i>

**Вывод:**  
Gitleaks сработал корректно по шаблону, но выявленные данные не являются уязвимыми.  
**Классификация:** Ложное срабатывание (false positive).

## Static Analysis (PHPStan)

## Static Analysis — PHPStan

Файл: `app/admin/index.php`

PHPStan обнаружил следующие потенциальные уязвимости:

- Строка 132: переменная `$smtp_server` может быть не определена
- Строка 140: `$AIM_IPs[0]` может не существовать, используется как `mixed`
- Строка 148: `$evil_bee` может быть не определён, используется в `echo`
- Строка 156: `$login` может быть не определён, участвует в конкатенации

Тип ошибок: необъявленные переменные и операции над `mixed` без проверки.

**Вывод:** потенциальные ошибки, которые могут быть использованы при атаке через crafted input (например, Notice to RCE).



## Общая сводка

| Инструмент               | Статус     | Найдено проблем | Подтверждено | Комментарий                                 |
|--------------------------|------------|------------------|---------------|----------------------------------------------|
| Gitleaks                 | Успешно    | 5                | 0             | Ложные срабатывания                          |
| PHPStan (SAST)           | Успешно    | 6                | 6             | Потенциально эксплуатируемые ошибки          |
| OWASP Dependency Check   | Неудача    | -                | -             | Ошибка в CI при сохранении артефакта         |
| OWASP ZAP (DAST)         | Успешно    | 27 предупреждений| 5+            | Реальные уязвимости подтверждены вручную     |

---

## Secrets Scan — Gitleaks

Файл: `app/top_security.php`  
Обнаружены совпадения по шаблону `generic-api-key` в строках 24–28.  
Фрагмент кода:

```php
$secret = "PGk+PHA+U2VjdXJlIHRoZSB3b3JsZC4g...";
$secret .= "...";
```

Содержимое — base64-кодированный HTML-текст, не связанный с API-ключами, паролями или токенами.  
Декодирование показывает художественный текст. Доступ к внешним ресурсам по этим значениям отсутствует.

Вывод: ложные срабатывания.

---

## Static Analysis — PHPStan

Файл: `app/admin/index.php`  
Найдены следующие проблемы:

```php
132: echo $smtp_server;
140: echo $AIM_IPs[0];
148: echo $evil_bee;
156: $link = "login/" . $login;
```

Комментарии PHPStan:

- `$smtp_server`, `$AIM_IPs`, `$evil_bee`, `$login` — переменные могут быть не инициализированы
- Операции над типом `mixed` без проверки типа
- Результаты могут привести к ошибке исполнения или неконтролируемому выводу

Вывод: ошибки подтверждены, требуют защиты и проверки типов. True positive.

---

## Component Analysis — Dependency Check

Сканирование не выполнено корректно: ошибка загрузки артефакта `upload-artifact@v1`.

Вывод: отчёт не получен, инструмент требует повторного запуска после фикса CI.

---

## DAST — OWASP ZAP

Инструмент: OWASP ZAP  
URL: `https://e1bf-5-231-41-176.ngrok-free.app`  
Метод: динамическое тестирование веб-приложения

Результаты:

- PASS: 39
- WARN: 27
- FAIL: 0

Подтвержденные уязвимости:

1. Directory Browsing  
   URL: `/documents/`  
   Возможность просмотра структуры каталогов.

2. Source Code Disclosure  
   URL: `/passwords/wp-config.bak`  
   Файл конфигурации PHP открыт к чтению, возможно содержит пароли.

3. Missing Anti-CSRF Tokens  
   Страницы: `login.php`, `user_new.php`  
   Формы не содержат токены CSRF, возможна подмена запроса.

4. Потенциальный XSS  
   URL: `login.php`, `user_new.php`  
   HTML-атрибуты управляются пользователем, может привести к XSS.

5. Отсутствие защитных заголовков:  
   `Content-Security-Policy`, `X-Frame-Options`, `Strict-Transport-Security`  
   Повышенный риск атак через браузер.

Вывод: уязвимости подтверждены, требуют устранения.
